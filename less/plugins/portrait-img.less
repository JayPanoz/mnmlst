/* Portrait aspect-ratio images (+ captions) */

@import (reference) '../functionalCSS/scale';
@import (reference) '../utils/rhythm';

// Mixins 

.break-or-dont() {
	-webkit-column-break-before: auto;
	page-break-before: auto;
	break-before: auto;	
}

.break-before() {
	-webkit-column-break-before: always;
	page-break-before: always;
	break-before: always;
}

.dont-break() {
	-webkit-column-break-inside: avoid;
	page-break-inside: avoid;
	break-inside: avoid;
}

.portrait(@imgHeight) {
  .portrait {
    width: 100%;
    height: (@imgHeight + 0%);
    margin: (@scale + 0em) 0;
    .break-or-dont;
    text-align: center;
  
      > img {
        width: auto;
        max-width: 100%;
        height: 100%;
        max-height: (@imgHeight + 0vh);
        object-fit: contain;
    }
  }
}

.portrait-caption(@imgHeight : 80, @captionHeight : 5, @minImgHeight : 60, @maxImgHeight : 600) {    
    .portrait-caption-@{imgHeight} {
        width: 100%;
        height: 99%;
        margin: (@scale + 0em) 0;
        .break-before;
        .dont-break;
        text-align: center;
        
        > img {
            width: auto;
            max-width: 100%;
            height: (@imgHeight + 0%);
            object-fit: contain;
        }
        
        > .caption {
            /* your styles */   
        }
    }
    
    @supports (height: 80vh) {
        .portrait-caption-@{imgHeight} {
        	min-height: 100vh;
            margin: 0;
         
            > img {
                height: (@imgHeight + 0vh);
                max-height: (@maxImgHeight + 0px);
            }
            
            > .caption {
                /* your styles */   
            }
        }
    }
    
    @supports (page-break-before: always) and (height: calc(98vh - 5em)) {
        .portrait-caption-@{imgHeight} {
            min-height: calc(~"100vh - 0px");
            margin: 0;
            
            > img {
                box-sizing: border-box;
                min-height: (@minImgHeight + 0vh);
                height: calc(~"98vh -" (@captionHeight + 0em));
                max-height: (@maxImgHeight + 0px);
                padding: 1vh 0;
            }
            
            > .caption {
                /* your styles */   
            }
        }
    }
}

// Output

.portrait(80);
.portrait-caption(80, 5, 60, 620);